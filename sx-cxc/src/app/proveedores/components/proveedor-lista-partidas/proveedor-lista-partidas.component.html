<div [formGroup]="parent">
  <table mat-table formArrayName="partidas" [dataSource]="dataSource" matSort>
    <ng-container matColumnDef="clave">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Producto</th>
      <td mat-cell *matCellDef="let row">{{row.clave}}</td>
    </ng-container>
    <ng-container matColumnDef="descripcion">
      <th mat-header-cell *matHeaderCellDef mat-sort-header>Descripci√≥n</th>
      <td mat-cell *matCellDef="let row">{{row.descripcion}}</td>
    </ng-container>
    <ng-container matColumnDef="unidad">
      <th mat-header-cell *matHeaderCellDef>Unidad</th>
      <td mat-cell *matCellDef="let row">{{row.unidad}}</td>
    </ng-container>

    <!-- <ng-container matColumnDef="moneda">
      <th mat-header-cell *matHeaderCellDef>Mon</th>
      <td mat-cell *matCellDef="let row">{{row.moneda}}</td>
    </ng-container> -->

    <ng-container matColumnDef="precioAnterior">
      <th mat-header-cell *matHeaderCellDef>P. Anterior</th>
      <td mat-cell *matCellDef="let row">{{row.precioAnterior | currency}}</td>
    </ng-container>

    <ng-container matColumnDef="diferencia">
      <th mat-header-cell *matHeaderCellDef>Differencia</th>
      <td mat-cell *matCellDef="let row">{{ getDirerencia(row) | percent }}</td>
    </ng-container>

    <ng-container matColumnDef="precioBruto">
      <th mat-header-cell *matHeaderCellDef>Precio</th>
      <td mat-cell *matCellDef="let row">
        <input type="number" [disabled]="readOnly" [(ngModel)]="row.precioBruto" [ngModelOptions]="{standalone: true}" (input)="actualizar(row)">
      </td>
    </ng-container>
    <ng-container matColumnDef="desc1">
      <th mat-header-cell *matHeaderCellDef>Desc 1</th>
      <td mat-cell *matCellDef="let row">
        <input type="number" [disabled]="readOnly" [(ngModel)]="row.desc1" [ngModelOptions]="{standalone: true, updateOn: 'blur'}"
          (input)="actualizar(row)">
      </td>
    </ng-container>
    <ng-container matColumnDef="desc2">
      <th mat-header-cell *matHeaderCellDef>Desc 2</th>
      <td mat-cell *matCellDef="let row">
        <input type="number" [disabled]="readOnly" [(ngModel)]="row.desc2" [ngModelOptions]="{standalone: true}" (input)="actualizar(row)">
      </td>
    </ng-container>

    <ng-container matColumnDef="desc3">
      <th mat-header-cell *matHeaderCellDef>Desc 3</th>
      <td mat-cell *matCellDef="let row" class="descuento">
        <input type="number" [disabled]="readOnly" [(ngModel)]="row.desc3" [ngModelOptions]="{standalone: true}" (input)="actualizar(row)">
      </td>
    </ng-container>

    <ng-container matColumnDef="desc4">
      <th mat-header-cell *matHeaderCellDef>Desc 4</th>
      <td mat-cell *matCellDef="let row" class="descuento">
        <input type="number" [disabled]="readOnly" [(ngModel)]="row.desc4" [ngModelOptions]="{standalone: true}" (input)="actualizar(row)">
      </td>
    </ng-container>

    <ng-container matColumnDef="precioNeto">
      <th mat-header-cell *matHeaderCellDef>Neto</th>
      <td mat-cell *matCellDef="let row">
        {{row.precioNeto | currency}}
      </td>
    </ng-container>

    <ng-container matColumnDef="operaciones">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let row, let i = index">
        <mat-icon color="warn" class="cursor-pointer" *ngIf="!readOnly" (click)="delete.emit(i)">delete</mat-icon>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayColumns"></tr>
    <tr mat-row *matRowDef="let cfdi; columns: displayColumns; "></tr>

  </table>
  <mat-paginator [pageSizeOptions]="[20, 50, 100, 200]" showFirstLastButtons></mat-paginator>
</div>
