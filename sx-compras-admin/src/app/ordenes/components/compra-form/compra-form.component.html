<mat-card>
  <form [formGroup]="form">
    <div layout layout-align="center center">
      <span class="mat-title pad-left pad-top">
        <span *ngIf="compra; else alta">
          <span>Compra: {{compra.folio}} ({{compra.sucursalNombre}})</span>
          <span class="pad-left pad-right">Status: {{compra.status}}</span>
          <span class="pad-left">({{compra.fecha | date: 'dd/MM/yyyy'}})</span>
        </span>
        <ng-template #alta>
          Alta de orden de compra
        </ng-template>
      </span>
      <span flex></span>
      <sx-compra-add-partida [parent]="form" [productos]="productos" (addPartida)="onInsertPartida($event)"></sx-compra-add-partida>
    </div>
    <mat-divider></mat-divider>
    <mat-card-content>

      <div layout>
        <sx-proveedor-field formControlName="proveedor" flex></sx-proveedor-field>
        <mat-form-field class="pad-left">
          <input matInput [matDatepicker]="myDatepicker" formControlName="fecha" placeholder="Fecha">
          <mat-datepicker-toggle matSuffix [for]="myDatepicker"></mat-datepicker-toggle>
          <mat-datepicker #myDatepicker></mat-datepicker>
        </mat-form-field>
        <sx-moneda-field [parent]="form" class="pad-left"></sx-moneda-field>
        <sx-tipo-cambio-field [parent]="form" class="pad-left"></sx-tipo-cambio-field>
      </div>

      <div layout>
        <sx-upper-case-field formControlName="comentario" flex></sx-upper-case-field>
      </div>

    </mat-card-content>
    <mat-divider></mat-divider>

    <div class="partidas-panel">
      <sx-compra-partidas-table [parent]="form" [partidas]="partidas.value"></sx-compra-partidas-table>
    </div>

    <mat-divider></mat-divider>
    <sx-compra-form-buttons [parent]="form" [status]="status" (save)="onSave()" (delete)="delete.emit(compra)">
    </sx-compra-form-buttons>


  </form>
</mat-card>
